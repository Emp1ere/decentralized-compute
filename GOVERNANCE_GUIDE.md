# Руководство по Управлению сетью

Раздел «Управление сетью» в дашборде предназначен для подключения узлов, добавления валидаторов и обновления версии протокола.

## 1. Назначение раздела

- **Подключение узлов** — добавление новых оркестраторов в управляемую сеть
- **Валидаторы** — назначение пользователей для независимой проверки результатов вычислений
- **Обновление протокола** — поэтапный rollout новой версии между узлами

## 2. Статус сети

Кнопка **«Показать статус сети»** обновляет:

| Поле | Описание |
|------|----------|
| Версия протокола | Текущая версия, под которой работает узел |
| Подключено узлов | Количество допущенных узлов |
| Подключено валидаторов | Количество допущенных валидаторов |
| Статус обновления | Состояние активного rollout (если есть) |

## 3. Добавление валидатора

1. Введите **ID пользователя** (client_id), которого нужно сделать валидатором
2. Если на сервере включён admission token — укажите его в поле **Admission token**
3. Нажмите **«Добавить валидатора»**

Валидатор участвует в разрешении спорных результатов при репликации (replication groups).

## 4. Добавление узла в сеть

1. Введите **ID узла** (например `orchestrator_node_2`)
2. При необходимости укажите **Admission token**
3. Нажмите **«Добавить узел»**

Узел будет добавлен в список допущенных. Синхронизация блокчейна и jobs выполняется через `PEER_URL` и эндпоинты `/receive_chain`, `/jobs/snapshot`.

## 5. Обновление версии протокола

Цепочка из трёх шагов:

1. **Предложить обновление** — выберите версию из списка, задайте минимум подтверждений (обычно = число узлов), нажмите «Предложить обновление»
2. **Подтвердить** — каждый узел нажимает «Подтвердить» (ack)
3. **Финализировать** — после набора требуемых подтверждений нажмите «Финализировать»

Количество подтверждений должно быть не меньше числа узлов для консенсуса.

## 6. Решение валидатора по группе репликации

При спорных или неоднозначных результатах:

1. Введите **ID группы репликации** (replication_group_id)
2. Выберите решение: **Принять результат** или **Отклонить результат**
3. При необходимости добавьте комментарий
4. Нажмите **«Отправить решение»**

## 7. Аргументация MVP (claims, demo-script)

Блок «Аргументация MVP» содержит:

- **claims** — структурированные утверждения о proof-points системы
- **demo-script** — сценарий демонстрации для разработки

Кнопка **«Подготовить demo-данные»** — только для dev-окружения.

---

## Оценка жизнеспособности модели в продакшене

### Текущая архитектура

- Состояние governance хранится в `decentralized_runtime.json` на каждом узле
- Синхронизация между узлами: `jobs/snapshot`, `runtime/snapshot` по `PEER_URL`
- Нет распределённого консенсуса для governance-решений

### Плюсы

- Простая модель, подходит для MVP и тестовой сети
- Минимальные зависимости, быстрый старт

### Минусы

- **Рассинхронизация** — при расхождении `decentralized_runtime.json` между узлами возможны конфликты
- **Единая точка отказа** — governance не реплицируется с гарантией консистентности
- **Отсутствие консенсуса** — rollout и admission не проходят через формальный consensus

### Рекомендации для продакшена

1. **Распределённое хранилище** — вынести governance в БД с репликацией, блокчейн или Raft/Paxos
2. **Явный consensus для rollout** — multi-sig или голосование узлов с кворумом
3. **Аудит и версионирование** — логирование всех изменений governance с версиями

### Вывод

Модель **жизнеспособна для MVP и тестовых сетей**. Для продакшена с несколькими независимыми операторами требуется доработка: распределённое хранилище и формальный consensus для governance-операций.
